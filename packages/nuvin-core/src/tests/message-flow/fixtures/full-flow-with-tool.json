{
  "name": "full_flow_with_tool_execution",
  "description": "Complete message flow: user input → LLM streaming → tool execution → final response",
  "config": {
    "agentId": "test-agent",
    "model": "test-model",
    "systemPrompt": "You are a helpful assistant that can read files.",
    "temperature": 0.7,
    "topP": 1.0,
    "maxTokens": 1000,
    "enabledTools": ["file_read"],
    "requireToolApproval": false
  },
  "conversationId": "test-conversation",
  "turns": [
    {
      "userMessage": "What is in the file /tmp/test.txt?",
      "llmResponses": [
        {
          "type": "tool_calls",
          "toolCalls": [
            {
              "id": "tool-call-1",
              "name": "file_read",
              "arguments": { "path": "/tmp/test.txt" }
            }
          ],
          "usage": {
            "prompt_tokens": 50,
            "completion_tokens": 25,
            "total_tokens": 75
          }
        },
        {
          "type": "text_stream",
          "content": "The file contains: Hello World!",
          "usage": {
            "prompt_tokens": 100,
            "completion_tokens": 50,
            "total_tokens": 150
          }
        }
      ],
      "toolMocks": {
        "tool-call-1": {
          "name": "file_read",
          "result": "Hello World!",
          "metadata": {
            "path": "/tmp/test.txt",
            "lines_read": 1
          },
          "durationMs": 50
        }
      },
      "expected": {
        "response": {
          "role": "assistant",
          "content": "The file contains: Hello World!"
        },
        "memory": [
          {
            "role": "user",
            "content": "What is in the file /tmp/test.txt?"
          },
          {
            "role": "assistant",
            "content": "",
            "hasToolCalls": true,
            "toolCallCount": 1,
            "toolCalls": [
              {
                "id": "tool-call-1",
                "name": "file_read"
              }
            ]
          },
          {
            "role": "tool",
            "name": "file_read",
            "tool_call_id": "tool-call-1",
            "status": "success",
            "contentContains": "Hello World!"
          },
          {
            "role": "assistant",
            "content": "The file contains: Hello World!",
            "hasToolCalls": false
          }
        ]
      }
    }
  ],
  "expected": {
    "totalFetchCalls": 2,
    "totalMemoryMessages": 4,
    "finalUsage": {
      "total_tokens": 150
    },
    "metrics": {
      "totalTokens": 225,
      "llmCallCount": 2,
      "toolCallCount": 1,
      "requestCount": 1
    }
  }
}
